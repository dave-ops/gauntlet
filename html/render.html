<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Centered Player with Moving World</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="400" height="400"></canvas>
    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        // Player stays centered
        const playerX = 200;
        const playerY = 200;
        const speed = 3;

        // World offset (shifts world around player)
        let worldOffsetX = 0;
        let worldOffsetY = 0;

        // Armor position (relative to world)
        let armorX = 300; // Starts at world (300, 100)
        let armorY = 100;
        let hasArmor = false;

        // Sword position (off-screen in world)
        let swordX = 450; // Starts at world (450, 200)
        let swordY = 200;
        let hasSword = false;

        const keys = {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false
        };

        window.addEventListener('keydown', (e) => {
            if (e.key in keys) keys[e.key] = true;
        });
        window.addEventListener('keyup', (e) => {
            if (e.key in keys) keys[e.key] = false;
        });

        // Animation state
        let legAngle = 0;
        let isMoving = false;

        // Draw basic stick figure
        function drawPerson(x, y) {
            ctx.beginPath();
            ctx.arc(x, y, 10, 0, Math.PI * 2); // Head
            ctx.fillStyle = '#FFD700';
            ctx.fill();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(x, y + 10);
            ctx.lineTo(x, y + 40); // Body
            ctx.lineWidth = 5;
            ctx.strokeStyle = '#0000FF';
            ctx.stroke();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(x - 15, y + 20);
            ctx.lineTo(x + 15, y + 20); // Arms
            if (hasSword) {
                ctx.lineTo(x + 25, y + 30); // Extend right arm with sword
                drawSword(x + 25, y + 30, Math.PI / 4);
            }
            ctx.stroke();
            ctx.closePath();

            const legBaseY = y + 40;
            const legLength = 20;
            const maxSwing = 10;
            let leftLegX = x - maxSwing * Math.sin(legAngle);
            let rightLegX = x + maxSwing * Math.sin(legAngle);
            let leftLegY = legBaseY + legLength;
            let rightLegY = legBaseY + legLength;

            ctx.beginPath();
            ctx.moveTo(x, legBaseY);
            ctx.lineTo(leftLegX, leftLegY); // Left leg
            ctx.moveTo(x, legBaseY);
            ctx.lineTo(rightLegX, rightLegY); // Right leg
            ctx.stroke();
            ctx.closePath();
        }

        // Draw armored version
        function drawArmorSprite(x, y) {
            ctx.beginPath();
            ctx.moveTo(x - 12, y - 15);
            ctx.lineTo(x + 12, y - 15);
            ctx.quadraticCurveTo(x + 15, y, x + 12, y + 10);
            ctx.lineTo(x - 12, y + 10);
            ctx.quadraticCurveTo(x - 15, y, x - 12, y - 15);
            ctx.fillStyle = '#A9A9A9';
            ctx.fill();
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(x - 8, y - 5);
            ctx.lineTo(x + 8, y - 5);
            ctx.lineWidth = 1;
            ctx.stroke();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(x - 15, y + 10);
            ctx.lineTo(x + 15, y + 10);
            ctx.lineTo(x + 20, y + 40);
            ctx.lineTo(x - 20, y + 40);
            ctx.fillStyle = '#A9A9A9';
            ctx.fill();
            ctx.stroke();
            ctx.closePath();

            const armBaseY = y + 20;
            const armLength = 18;
            const armSwing = 5;
            let leftArmX = x - armLength + armSwing * Math.sin(legAngle);
            let rightArmX = x + armLength - armSwing * Math.sin(legAngle);

            ctx.beginPath();
            ctx.moveTo(x - 15, armBaseY);
            ctx.lineTo(leftArmX, armBaseY + 10); // Left arm
            ctx.moveTo(x + 15, armBaseY);
            ctx.lineTo(rightArmX, armBaseY + 10); // Right arm
            if (hasSword) {
                drawSword(rightArmX, armBaseY + 10, Math.PI / 4);
            }
            ctx.lineWidth = 4;
            ctx.strokeStyle = '#A9A9A9';
            ctx.stroke();
            ctx.closePath();

            const legBaseY = y + 40;
            const legLength = 25;
            const maxSwing = 12;
            let leftLegX = x - maxSwing * Math.sin(legAngle);
            let rightLegX = x + maxSwing * Math.sin(legAngle);
            let leftLegY = legBaseY + legLength;
            let rightLegY = legBaseY + legLength;

            ctx.beginPath();
            ctx.moveTo(x - 10, legBaseY);
            ctx.lineTo(leftLegX, leftLegY); // Left leg
            ctx.moveTo(x + 10, legBaseY);
            ctx.lineTo(rightLegX, rightLegY); // Right leg
            ctx.lineWidth = 6;
            ctx.strokeStyle = '#A9A9A9';
            ctx.stroke();
            ctx.closePath();
        }

        // Draw armor item
        function drawArmorItem(x, y) {
            ctx.beginPath();
            ctx.moveTo(x - 10, y - 10);
            ctx.lineTo(x + 10, y - 10);
            ctx.quadraticCurveTo(x + 12, y, x + 10, y + 15);
            ctx.lineTo(x - 10, y + 15);
            ctx.quadraticCurveTo(x - 12, y, x - 10, y - 10);
            ctx.fillStyle = '#A9A9A9';
            ctx.fill();
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(x - 6, y);
            ctx.lineTo(x + 6, y);
            ctx.lineWidth = 1;
            ctx.stroke();
            ctx.closePath();
        }

        // Draw sword item or in hand
        function drawSword(x, y, angle) {
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(angle);
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.lineTo(20, 0); // Blade
            ctx.lineWidth = 3;
            ctx.strokeStyle = '#C0C0C0';
            ctx.stroke();
            ctx.moveTo(0, -5);
            ctx.lineTo(0, 5); // Crossguard
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#808080';
            ctx.stroke();
            ctx.restore();
        }

        // Check collision with items (world-adjusted positions)
        function checkCollision() {
            const playerBounds = { left: playerX - 15, right: playerX + 15, top: playerY - 10, bottom: playerY + 60 };
            
            if (!hasArmor) {
                const armorScreenX = armorX - worldOffsetX;
                const armorScreenY = armorY - worldOffsetY;
                const armorBounds = { left: armorScreenX - 12, right: armorScreenX + 12, top: armorScreenY - 10, bottom: armorScreenY + 15 };
                if (
                    playerBounds.right > armorBounds.left &&
                    playerBounds.left < armorBounds.right &&
                    playerBounds.bottom > armorBounds.top &&
                    playerBounds.top < armorBounds.bottom
                ) {
                    hasArmor = true;
                }
            }

            if (!hasSword) {
                const swordScreenX = swordX - worldOffsetX;
                const swordScreenY = swordY - worldOffsetY;
                const swordBounds = { left: swordScreenX - 5, right: swordScreenX + 20, top: swordScreenY - 5, bottom: swordScreenY + 5 };
                if (
                    playerBounds.right > swordBounds.left &&
                    playerBounds.left < swordBounds.right &&
                    playerBounds.bottom > swordBounds.top &&
                    playerBounds.top < swordBounds.bottom
                ) {
                    hasSword = true;
                }
            }
        }

        function updatePosition() {
            isMoving = false;

            if (keys.ArrowUp) {
                worldOffsetY -= speed; // World moves down (player "moves up")
                isMoving = true;
            }
            if (keys.ArrowDown) {
                worldOffsetY += speed; // World moves up
                isMoving = true;
            }
            if (keys.ArrowLeft) {
                worldOffsetX -= speed; // World moves right
                isMoving = true;
            }
            if (keys.ArrowRight) {
                worldOffsetX += speed; // World moves left
                isMoving = true;
            }

            if (isMoving) {
                legAngle += 0.2;
            } else {
                legAngle = Math.sin(legAngle) * 0.1;
            }

            checkCollision();
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw items with world offset
            if (!hasArmor) {
                drawArmorItem(armorX - worldOffsetX, armorY - worldOffsetY);
            }
            if (!hasSword) {
                drawSword(swordX - worldOffsetX, swordY - worldOffsetY, 0);
            }

            // Draw player at center
            updatePosition();
            if (hasArmor) {
                drawArmorSprite(playerX, playerY);
            } else {
                drawPerson(playerX, playerY);
            }

            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>